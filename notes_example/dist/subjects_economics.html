<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Notes & Guides</title>
  <!-- Tailwind CSS -->
<link href="./css/tailwind.css" rel="stylesheet"/>

<!-- Prism Css -->
<link href="./css/prism.css" rel="stylesheet" />

<!-- Mathjax -->
<script>
MathJax = {
  tex: {
  	processEscapes: true
  }
}
</script>

<script type="text/javascript" async
  src="./mathjax/tex-mml-chtml.js">
</script>

<!-- Your CSS file should come here -->
<link href="./css/style.css" rel="stylesheet" />

<!-- Toc tree file -->
<script src="./js/toc_tree.js"></script>

</head>
<body class="flex flex-col h-screen text-gray-700 dark:bg-darkgray dark:text-gray-400">

<div id="header" class="w-full border-b border-gray-500
shadow-md items-center h-16">
<nav class="flex items-center justify-between flex-wrap p-4">
  <div class="flex items-center flex-no-shrink mr-6">
    <span class="font-semibold text-xl tracking-tight">
      <a href="./index.html">Notes</a>
    </span>
  </div>
  <div class="block flex-grow lg:flex lg:items-center lg:w-auto">
    <div class="text-sm lg:flex-grow">
      <a href="#top" class="absolute right-0 bottom-0 mb-8 mr-24 z-100 bg-gray-500 hover:bg-gray-700 text-white font-bold rounded-full h-12 w-12 flex items-center justify-center">
        Top
      </a>
      <input id="search-bar" onkeyup="search()"
      onfocusin='showResults()'
      class="float-right mx-4 w-1/6 rounded-lg px-4 py-1 border-solid border-2 border-gray-700 dark:border-gray-500 text-gray-400 dark:text-gray-900 focus:border-green-500 dark:focus:border-blue-500 focus:text-gray-500 dark:focus:text-gray-500 dark:bg-midgray" placeholder="Search..."/>
      <ul id="search-bar-results"
      class="z-50 absolute w-5/6 sm:w-4/6 md:w-3/6 lg:w-2/6 xl:w-1/6
right-0 mt-12 mr-20 bg-white dark:bg-midgray p-4 shadow-lg border
border-solid border-gray-500 rounded-md" style="display: none;"></ul>
      <button type="button" class="float-right rounded-lg px-4 py-1 border-2 bg-black text-gray-300 bg-gray-500 dark:bg-gray-300 dark:text-gray-700" onclick="toggleLight()">Toggle dark-mode</button>
    </div>
  </div>
</nav>
</div>

<div id="content" class="top flex flex-col lg:flex-row overflow-y-auto" onclick="hideResults()">
  <div id="sidebar" class="bg-gray-200 dark:bg-midgray md:shadow-2xl md:rounded-md md:mt-12 md:mx-12 md:px-24 md:py-12 lg:m-0 lg:rounded-none lg:border-r lg:border-gray-500 lg:fixed lg:pt-2 lg:w-64 lg:px-2 lg:overflow-y-auto lg:inset-y-0 lg:mt-16">
  <div id="toc"></div>
  </div>

  <div id="content-container" class="flex-grow px-8 py-12 sm:px-12 md:px-16 lg:ml-64 lg:px-20
lg:overflow-x-auto xl:px-56" onscroll="scrollSpy()">
    <div id="top"></div>
    <div id="file-name" class="flex rounded-t border border-gray-300 dark:border-gray-700 bg-gray-100 dark:bg-midgray py-2 pl-4 font-bold">
      <img class="w-6 h-6 mr-2" src="./icons/folders.png">
      <p>subjects_economics.org</p>
    </div>
    <div id="inner-container" class="px-20 py-12 pb-32 mb-12 shadow-2xl rounded-md">
      <h1 class="mt-32 mb-6 text-6xl text-gray-700 dark:text-gray-400 border-b hover:text-green-500 dark:hover:text-blue-500 border-gray-500">Economics</h1><h2 class="mt-20 mb-6 text-5xl text-gray-700 dark:text-gray-400 border-b hover:text-green-500 dark:hover:text-blue-500 border-gray-500">Simple Interest</h2><p class="my-2">\[SI = P * (1 + r)^t\]
</p>

<p class="my-2">Where:
</p>

<ul class="list-disc my-8"><li class="ml-10"><p class="my-2">SI = Simple Interest
</p>
</li>
<li class="ml-10"><p class="my-2">P = Principal
</p>
</li>
<li class="ml-10"><p class="my-2">r = Interest Rate
</p>
</li>
<li class="ml-10"><p class="my-2">t = Time
</p>
</li>
</ul>

    </div>
  </div>
</div>

<div id="footer" class="hidden fixed bottom-0 w-full border-t border-solid border-gray-500
h-8 text-center bg-white">
<p>Exported with org-tailwind</p>
</div>

<script>
function getElementsByTagNames(list,obj) {
	if (!obj) var obj = document;
	var tagNames = list.split(',');
	var resultArray = new Array();
	for (var i=0;i < tagNames.length;i++) {
		var tags = obj.getElementsByTagName(tagNames[i]);
		for (var j=0;j < tags.length;j++) {
			resultArray.push(tags[j]);
		}
	}
	var testNode = resultArray[0];
	if (!testNode) return [];
	if (testNode.sourceIndex) {
		resultArray.sort(function (a,b) {
				return a.sourceIndex - b.sourceIndex;
		});
	}
	else if (testNode.compareDocumentPosition) {
		resultArray.sort(function (a,b) {
				return 3 - (a.compareDocumentPosition(b) & 6);
		});
	}
	return resultArray;
}

function createTOC() {
	// Add go to top button
	let top = document.createElement('a');
	top.innerHTML = 'Top';
	top.href = '#top';
	top.className += 'top absolute right-0 bottom-0 mb-8 mr-24 z-100 bg-gray-500 hover:bg-gray-700 text-white font-bold rounded-full h-12 w-12 flex items-center justify-center';

    // The tags with the headlines
	let headlines = getElementsByTagNames('h1,h2,h3');

	if (headlines.length < 2) return false;

    // Populate the #toc div
	let toc = document.getElementById('toc');

    // Header counts for numbering
    let header_1 = 0;
    let header_2 = 0;
    let header_3 = 0;
    let header_4 = 0;
    let header_5 = 0;
    let header_6 = 0;

	for (var i=0;i < headlines.length;i++) {

		let tocHeader = document.createElement('a');

        // Tailwind.css classes
		tocHeader.className = 'px-2 py-1';
        tocHeader.className += ' text-sm my-1 hover:bg-gray-300 dark:hover:bg-darkgray dark:border-gray-500';

        // Make the first header active
        // This will be used for the scroll spy
        if (i == 0) {
            tocHeader.className += ' border-r-4 border-green-500 dark:border-blue-500 bg-gray-300 dark:bg-darkgray';
        }
	
        // Add the header to the table of contents
        toc.appendChild(tocHeader);

        switch (headlines[i].nodeName) {
          case 'H1':
            tocHeader.className += ' block mt-2 ml-0';
            header_1 += 1;
            header_2 = 0;
            header_3 = 0;
            header_4 = 0;
            header_5 = 0;
            header_6 = 0;

          	// Numbering
          	tocHeader.innerHTML += '<b>' + header_1 + '.</b> ';
            
            break;

          case 'H2':
            tocHeader.className += ' block ml-5';
            header_2 += 1;
            header_3 = 0;
            header_4 = 0;
            header_5 = 0;
            header_6 = 0;

          	// Numbering
          	tocHeader.innerHTML += '<b>' + header_1 + '.' + header_2 + '.</b> ';
            break;

          case 'H3':
            tocHeader.className += ' block ml-12';
            header_3 += 1;
            header_4 = 0;
            header_5 = 0;
            header_6 = 0;

          	// Numbering
          	tocHeader.innerHTML += '<b>' + header_1 + '.' + header_2 + '.' + header_3 + '.</b> ';
            break;

          case 'H4':
            tocHeader.className += ' block ml-20';
            header_4 += 1;
            header_5 = 0;
            header_6 = 0;

          	// Numbering
          	tocHeader.innerHTML += '<b>' + header_1 + '.' + header_2 + '.' + header_3 + '.' + header_4 + '.</b> ';
            break;

          case 'H5':
            tocHeader.className += ' block ml-32';
            header_5 += 1;
            header_6 = 0;

          	// Numbering
          	tocHeader.innerHTML += '<b>' + header_1 + '.' + header_2 + '.' + header_3 + '.' + header_4 + '.' + header_5 + '.</b> ';
            break;

          case 'H6':
            tocHeader.className += ' block ml-48';
            header_6 += 1;

          	// Numbering
          	tocHeader.innerHTML += '<b>' + header_1 + '.' + header_2 + '.' + header_3 + '.' + header_4 + '.' + header_5 + '.' + header_6 + '.</b> ';
            break;
        }       
        
        // Header title
        tocHeader.innerHTML += headlines[i].innerHTML;
		
        // Add a link to the header
		let headerId = headlines[i].id || 'toc-link-' + i;
		headlines[i].id = headerId;
        tocHeader.id = "goto-" + headerId;
		tocHeader.href = '#' + headerId;
	}
}

createTOC();

// Populate search bar
let searchBar = document.getElementById('search-bar')
let searchBarResults = document.getElementById('search-bar-results')
for(let i = 0; i < tocTree.length; i++) {
    let heading = tocTree[i]
    let item = document.createElement('li')
    let link = document.createElement('a')
    link.href = heading.file + '#toc-link-' + heading.index
    link.className = "p-2 block rounded-md hover:bg-gray-300 dark:hover:bg-darkgray"
    link.style.display = 'none'

    if (heading.name === heading.parent) {
        link.innerText = heading.name
    } else {
        link.innerText = heading.name + ' > ' + heading.parent
    }

    item.appendChild(link)
    searchBarResults.appendChild(item)
}

// Show results on search bar focus
function showResults(){
    searchBarResults.style.display = ''
}

function hideResults(){
    searchBarResults.style.display = 'none'
    searchBar.value = ''
}

// Search Bar
function search(){
    let searchBar = document.getElementById('search-bar')
    let filter = searchBar.value.toUpperCase()
    let count = 0

    let searchResults = searchBarResults.getElementsByTagName('li')

    for(let i = 0; i < searchResults.length; i++) {
        let link = searchResults[i].getElementsByTagName('a')[0]
        let txtValue = link.textContent || link.innerText

        if (txtValue.toUpperCase().indexOf(filter) > -1 && count < 10) {
            link.style.display = ''
            count += 1
        } else {
            link.style.display = 'none'
        }
    }
}


// Check if an element is visible
function isElementVisible (el, parent) {
    let rect = el.getBoundingClientRect();

    return (
        rect.top >= parent.getBoundingClientRect().top &&
        rect.left >= 0 &&
        rect.bottom <= (parent.clientHeight + parent.getBoundingClientRect().top) &&
        rect.right <= (parent.clientWidth)
    );
}


DOMTokenList.prototype.addMany = function(classes) {
    var array = classes.split(' ');
    for (var i = 0, length = array.length; i < length; i++) {
      this.add(array[i]);
    }
}

DOMTokenList.prototype.removeMany = function(classes) {
    var array = classes.split(' ');
    for (var i = 0, length = array.length; i < length; i++) {
      this.remove(array[i]);
    }
}

// Scroll Spy
// Everything is run inside the function because offsets
// are created due to tailwind.css classes as it changes
// the height/position of the elements after the page is loaded
function scrollSpy () {
  let headings = document.querySelectorAll('[id^="toc-link-"]');
  let headingsTopOffsets = {};
  let i = 0;

  let selectedClassName = "border-r-4 border-green-500 dark:border-blue-500 bg-gray-300 dark:bg-darkgray";

  Array.prototype.forEach.call(headings, function(s) {
    headingsTopOffsets[s.id] = s.offsetTop;
  });
  
  
  let scrollEl = document.getElementById("content-container");
  let scrollPosition = scrollEl.scrollTop + 150;

  let sidebar = document.getElementById('sidebar');

  for (i in headingsTopOffsets) {
    if (headingsTopOffsets[i] <= scrollPosition) {
      document.getElementsByClassName(selectedClassName)[0].classList.removeMany(selectedClassName);
      document.querySelector(`a[id^="goto-${i}"]`).classList.addMany(selectedClassName);

      // Scroll the sidebar to the current heading if not visible
      let tocItem = document.getElementById(`goto-${i}`);
      if (!isElementVisible(tocItem, sidebar)) {
          tocItem.scrollIntoView();
      }
    }
  }

};

// Manage dark theme
// On page load or when changing themes, best to add inline in `head` to avoid FOUC
if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
  document.documentElement.classList.add('dark')
} else {
  document.documentElement.classList.remove('dark')
}

function toggleLight() {
  if (localStorage.theme === 'light') {
    localStorage.setItem('theme', 'dark');
  } else {
    localStorage.setItem('theme', 'light');
  }
  location.reload();
  return false;
}

</script>

<script src="./js/prism.js"></script>
<script src="./js/mermaid.min.js"></script>
<script>mermaid.initialize({startOnLoad:true});</script>

</body>
</html>
